<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>多视图几何（四） | KMnO4的行云小扎</title><meta name="keywords" content="计算机视觉,SFM"><meta name="author" content="KMnO4"><meta name="copyright" content="KMnO4"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Chapter 4 Estimating Point Correspondence4.1 From Photometry to GeometryIn the last sections, we discussed how points and lines are transformed from 3D world coordinates to 2D image and pixel coordina">
<meta property="og:type" content="article">
<meta property="og:title" content="多视图几何（四）">
<meta property="og:url" content="https://wastoon.github.io/2022/02/28/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E5%9B%9B%EF%BC%89/index.html">
<meta property="og:site_name" content="KMnO4的行云小扎">
<meta property="og:description" content="Chapter 4 Estimating Point Correspondence4.1 From Photometry to GeometryIn the last sections, we discussed how points and lines are transformed from 3D world coordinates to 2D image and pixel coordina">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wastoon.github.io/img/MVG-4-cover.png">
<meta property="article:published_time" content="2022-02-28T06:43:44.000Z">
<meta property="article:modified_time" content="2022-02-28T07:07:47.826Z">
<meta property="article:author" content="KMnO4">
<meta property="article:tag" content="计算机视觉">
<meta property="article:tag" content="SFM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wastoon.github.io/img/MVG-4-cover.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://wastoon.github.io/2022/02/28/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E5%9B%9B%EF%BC%89/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '多视图几何（四）',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-02-28 15:07:47'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-clock/lib/clock.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.min.css" media="defer" onload="this.media='all'"><script async src="https://cdn.jsdelivr.net/npm/hexo-butterfly-tag-plugins-plus@latest/lib/carousel-touch.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-filter-gitcalendar/lib/gitcalendar.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/icon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 网站统计</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 自留地</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 吉他谱</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 嗑盐&amp;摸鱼</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 文献</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 经典开源项目</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 个人项目</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/MVG-4-cover.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">KMnO4的行云小扎</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 网站统计</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 自留地</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 吉他谱</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 嗑盐&amp;摸鱼</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 文献</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 经典开源项目</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 个人项目</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">多视图几何（四）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-02-28T06:43:44.000Z" title="发表于 2022-02-28 14:43:44">2022-02-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-02-28T07:07:47.826Z" title="更新于 2022-02-28 15:07:47">2022-02-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/">计算机视觉</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/SFM/">SFM</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>12分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="多视图几何（四）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Chapter-4-Estimating-Point-Correspondence"><a href="#Chapter-4-Estimating-Point-Correspondence" class="headerlink" title="Chapter 4 Estimating Point Correspondence"></a>Chapter 4 Estimating Point Correspondence</h1><h2 id="4-1-From-Photometry-to-Geometry"><a href="#4-1-From-Photometry-to-Geometry" class="headerlink" title="4.1 From Photometry to Geometry"></a>4.1 From Photometry to Geometry</h2><p>In the last sections, we discussed how points and lines are transformed from 3D world coordinates to 2D image and pixel coordinates.</p>
<p>In practice, <code>we do not actually observe points or lines, but rather brightness or color values</code> at the individual pixels. In order to transfer from this photometric representation to a geometric representation of the scene, one can identify points with <code>characteristic image features</code> and try to associate these points with corresponding points in the other frames.</p>
<p>The matching of corresponding points will allow us to infer 3D structure. Nevertheless, one should keep in mind that this approach is <code>suboptimal</code>:<code>By selecting a small number of feature points</code> from each image, we <code>throw away a large amount of potentially useful information</code> contained in each image. Yet, retaining all image information is computationally challenging. The selection and matching of a small number of feature points, on the other hand, was shown to permit tracking of 3D objects from a moving camera in real time.</p>
<h2 id="4-2-Example-of-tracking"><a href="#4-2-Example-of-tracking" class="headerlink" title="4.2 Example of tracking"></a>4.2 Example of tracking</h2><p><img src="https://cdn.jsdelivr.net/gh/Wastoon/myPicGo/img/06e0e660b240fe9932572112a1b19be0.png"></p>
<h2 id="4-3-Identifying-Corresponding-Points"><a href="#4-3-Identifying-Corresponding-Points" class="headerlink" title="4.3 Identifying Corresponding Points"></a>4.3 Identifying Corresponding Points</h2><p><img src="https://cdn.jsdelivr.net/gh/Wastoon/myPicGo/img/2173ef034aef7823c285db3f92ced945.png"></p>
<p>To identify corresponding points in two or more images is one of the biggest challenges in computer vision. Which of the points identified in the left image corresponds to which point in the right one?</p>
<h2 id="4-4-Non-rigid-Deformation"><a href="#4-4-Non-rigid-Deformation" class="headerlink" title="4.4 Non-rigid Deformation"></a>4.4 Non-rigid Deformation</h2><p>In what follows we will assume that objects move rigidly.<br>However, in general, objects may also deform <code>non-rigid</code>. Moreover, there may be <code>partial occlusions</code>:<br><img src="https://cdn.jsdelivr.net/gh/Wastoon/myPicGo/img/ffa5ad0e2093698793330158d8f18c0e.png"></p>
<h2 id="4-5-Small-Deformation-versus-Wide-Baseline"><a href="#4-5-Small-Deformation-versus-Wide-Baseline" class="headerlink" title="4.5 Small Deformation versus Wide Baseline"></a>4.5 Small Deformation versus Wide Baseline</h2><p>In point matching one distinguishes two cases:</p>
<ul>
<li><code>Small deformation</code>: The deformation from one frame to the other is assumed to be (infinitesimally) small. In this case the displacement from one frame to the other can be estimated by classical <code>optical flow estimation</code>, for example using the methods of <code>Lucas/Kanade</code> or <code>Horn/Schunck</code>. In particular, these methods allow to model dense deformation fields (giving a displacement for every pixel in the image). But one can also track the displacement of a few feature points which is typically faster.</li>
<li><code>Wide baseline stereo</code>: In this case the displacement is assumed to be large. A dense matching of all points to all is in general computationally infeasible. Therefore, one typically selects a <code>small number of feature points</code> in each of the images and develops efficient methods to <code>find an appropriate pairing of points</code>.</li>
</ul>
<h2 id="4-6-Small-Deformation"><a href="#4-6-Small-Deformation" class="headerlink" title="4.6 Small Deformation"></a>4.6 Small Deformation</h2><p>The transformation of all points of a rigidly moving obnect is given by:<br><img src="https://cdn.jsdelivr.net/gh/Wastoon/myPicGo/img/30d3d0d56c56e95291738783f22fa0c.jpg"><br>$$<br>x_2 &#x3D; h(x_1) &#x3D; \frac{1}{\lambda _2(\textbf{X})}(R\lambda_1(\textbf{X})x_1 + T).<br>$$</p>
<p>Locally this motion can be <code>approximated</code> in several ways.</p>
<ul>
<li><p>Translational model:<br>$$<br>h(x) &#x3D; x + b.<br>$$</p>
</li>
<li><p>Affine model:</p>
<p>  $$<br>  h(x) &#x3D; Ax + b.<br>  $$<br>  The 2D affine model can also be written as:<br>  $$h(x) &#x3D; x + u(x)\quad (u就是像素从当前帧到下一帧中的运动) $$<br>  with<br>  $$<br>  u(x) &#x3D; S(x)p &#x3D; \left(\begin{matrix}<br>  x &amp;y&amp;1&amp;0&amp;0&amp;0\\<br>  0&amp;0&amp;0&amp;x&amp;y&amp;1<br>  \end{matrix}\right)(p_1, p_2, p_3,p_4,p_5,p_6)^T &#x3D;<br>  \left(\begin{matrix}<br>  p_1x+p_2y+p_3\\<br>  p_4x+p_5y+p_6<br>  \end{matrix}\right).<br>  $$</p>
</li>
</ul>
<h2 id="4-7-Optic-Flow-Estimation"><a href="#4-7-Optic-Flow-Estimation" class="headerlink" title="4.7 Optic Flow Estimation"></a>4.7 Optic Flow Estimation</h2><p>The <code>optic flow</code> refers to the apparent 2D motion field observable between consecutive images of a video. It is different from the motion of objects in the scene, in the extreme case of motion along the camera axis, for example, there is no optic flow, while on the other hand camera rotation generates an optic flow field even for entirely static scenes.</p>
<p>In 1981, two seminal works on optic flow estimation were published, namely the works of <code>Lucas &amp; Kanade</code>, and of <code>Horn &amp; Schunck</code>. Both methods have become very influential with thousands of citations. They are complementary in the sense that the Lucas-Kanade method generates sparse flow vectors under the assumption of constant motion in a local neighborhood, whereas the Horn-Schunck method generates a dense flow field under the assumption of spatially smooth flow fields. Despite more than 30 years of research, the estimation of optic flow fields is still a highly active research direction.</p>
<h2 id="4-8-The-Lucas-Kanade-Method"><a href="#4-8-The-Lucas-Kanade-Method" class="headerlink" title="4.8 The Lucas-Kanade Method"></a>4.8 The Lucas-Kanade Method</h2><ul>
<li><p><code>Brightness Constancy Assumption</code>: Let $x(t)$ denote a moving point at time $t$, and $I(x,t)$ a video sequence, then:<br>  $$<br>  I(x(t), t) &#x3D; const. \quad \forall t,<br>  $$<br>  i.e. the brightness of point $x(t)$ is constant. Then the total time derivative must be zero:<br>  $$<br>  \frac{d}{dt}I(x(t), t) &#x3D; \nabla I^T(\frac{dx}{dt}) + \frac{\partial I}{\partial t} &#x3D; 0.<br>  $$<br>  This constraint is often called the (different) <code>optical flow constraint</code>. The desired local flow vector (velocity) is given by $v &#x3D; \frac{dx}{dt}$.</p>
</li>
<li><p><code>Constant motion in a neighborhood</code>: Since the above equation cannot be solved for $v$, one assumes that $v$ is constant over a neighborhood $W(x)$ of the point $x$:<br>  $$<br>  \nabla I(x’, t)^T v + \frac{\partial I}{\partial t}(x’, t) &#x3D; 0 \quad \forall x’ \in W(x).<br>  $$</p>
</li>
</ul>
<p>The brightness is typically not exactly constantly and the velocity is typically not exactly the same for the local neighborhood.</p>
<p><code>Lucas and Kanade(1981)</code> therefore compute the best velocity vector $v$ for the point $x$ by minimizing the <code>least squares error</code>:<br>$$<br>E(v) &#x3D; \int_{W(x)}|\nabla I(x’, t)^Tv + I_t(x’, t)|^2dx’.<br>$$</p>
<p>Expanding the terms and setting the derivative to zero one obtains:<br>$$<br>\frac{dE}{dv} &#x3D; 2Mv + 2q &#x3D; 0,<br>$$<br>with<br>$$<br>M &#x3D; \int_{W(x)}\nabla I\nabla I^T dx’, \quad and \quad q &#x3D; \int_{W(x)}I_t\nabla Idx’.<br>$$<br><img src="https://cdn.jsdelivr.net/gh/Wastoon/myPicGo/img/be844ec34f53801541b876e5c1cd1cd.jpg"><br>If $M$ is invertible, i.e. $det(M)\neq 0$, then the solution is:<br>$$<br>v &#x3D; -M^{-1}q.<br>$$</p>
<h2 id="4-9-Estimating-Local-Displacements"><a href="#4-9-Estimating-Local-Displacements" class="headerlink" title="4.9 Estimating Local Displacements"></a>4.9 Estimating Local Displacements</h2><ul>
<li>Translational motion: Lucas &amp; Kanade 1981:<br>  $$<br>  E(b) &#x3D; \int_{W(x)} |\nabla I^T b+ I_t|^2dx’ \rightarrow min.\\<br>  \frac{dE}{db}&#x3D;0 \Leftrightarrow b &#x3D; …<br>  $$</li>
<li>Affine motion: (为window内的像素细致的估计各自的运动)<br>  $$<br>  E(p) &#x3D; \int_{W(x)} |\nabla I^T S(x’)p+ I_t|^2dx’ \rightarrow min.\\<br>  \frac{dE}{dp}&#x3D;0 \Leftrightarrow p &#x3D; …<br>  $$<br>  where:<br>  $$<br>  u(x) &#x3D; S(x)p &#x3D; \left(\begin{matrix}<br>  x &amp;y&amp;1&amp;0&amp;0&amp;0\\<br>  0&amp;0&amp;0&amp;x&amp;y&amp;1<br>  \end{matrix}\right)(p_1, p_2, p_3,p_4,p_5,p_6)^T &#x3D;<br>  \left(\begin{matrix}<br>  p_1x+p_2y+p_3\\<br>  p_4x+p_5y+p_6<br>  \end{matrix}\right).<br>  $$</li>
</ul>
<h2 id="4-10-When-can-Small-Motion-be-Estimated"><a href="#4-10-When-can-Small-Motion-be-Estimated" class="headerlink" title="4.10 When can Small Motion be Estimated?"></a>4.10 When can Small Motion be Estimated?</h2><p>In the formalism of Lucas and Kanade, one cannot always estimate a translational motion. This problem is often referred to as the <code>aperture problem</code>. It arises for example, if the region in the window $W(x)$ around the point $x$ has entirely constant intensity (for example a white wall), because then $\nabla I(x)&#x3D;0$ and $I_t(x)&#x3D;0$ for all points in the window.</p>
<p>In order for the solution of $b$ to be unique the <code>structure tensor</code>:<br>$$<br>M(x) &#x3D; \int_{W(x)} \left(\begin{matrix}<br>    I_x^2 &amp;I_xI_y\\<br>    I_xI_y &amp;I_y^2<br>\end{matrix} \right)dx’.<br>$$<br>needs to be invertible. That means that we must have $det(M)\neq 0$.</p>
<p>If the structure tensor is not invertible but not zero, then one can estimate the <code>normal motion</code>, i.e. the motion in direction of the image gradient.</p>
<p>For those points with $det(M(x))\neq 0$, we can compute a motion vector $b(x)$. This leads to the following simple feature tracker.</p>
<h2 id="4-11-A-Simple-Feature-Tracking-Algorithm"><a href="#4-11-A-Simple-Feature-Tracking-Algorithm" class="headerlink" title="4.11 A Simple Feature Tracking Algorithm"></a>4.11 A Simple Feature Tracking Algorithm</h2><p>Feature tracking over a sequence of images can now be done as follows:</p>
<ul>
<li>For a given time instance $t$, compute at each point $x\in \Omega$ the structure tensor”<br>  $$<br>  M(x) &#x3D; \int_{W(x)} \left(\begin{matrix}<br>  I_x^2 &amp;I_xI_y\\<br>  I_xI_y &amp;I_y^2<br>  \end{matrix} \right)dx’.<br>  $$</li>
<li>Mark all points $x\in \Omega$ for which the determinant of $M$ is larger than a threshold $\theta &gt;0$:<br>  $$det(M(x))\geq 0<br>  $$</li>
<li>For all these points the local velocity is given by:<br>  $$<br>  b(x, t) &#x3D; -M(x)^{-1}\left(\begin{matrix}<br>  \int I_xI_t dx’\\<br>  \int I_yI_t dx’<br>  \end{matrix} \right).<br>  $$</li>
<li>Repeat the above steps for the points $x+b$ at time $t+1$.</li>
</ul>
<h2 id="4-12-Robust-Feature-Point-Extraction"><a href="#4-12-Robust-Feature-Point-Extraction" class="headerlink" title="4.12 Robust Feature Point Extraction"></a>4.12 Robust Feature Point Extraction</h2><p>Even $det(M(x))\neq 0$ does not guarantee robust estimates of velocity—the inverse of $M(x)$ may not be very stable if, for example, the determinant of $M$ is very small. Thus locations with $det(M)\neq 0$ are not always reliable features for tracking.</p>
<p>One of the classical feature detectors was proposed independently by <code>Forstner 1984</code> and <code>Harris &amp; Stephens 1988</code>.<br>It is based on the <code>structure tensor</code>:<br>$$<br>M(x) &#x3D; G_{\sigma}*\nabla I \nabla I^T &#x3D; \int G_\sigma (x-x’)\left(\begin{matrix}<br>    I_x^2 &amp;I_xI_y\\<br>    I_xI_y &amp;I_y^2<br>    \end{matrix} \right)(x’)dx’,<br>$$<br>where rather than simple summing over the window $W(x)$ we perform a summation weighted by a Gaussian $G$ of width $\sigma$.<br>The Forstner&#x2F;Harris detector is given by:<br>$$<br>C(x) &#x3D; det(M) + \kappa trace^2(M).<br>$$</p>
<p>One selects points for which $C(x)&gt;\theta$ with a threshold $\theta &gt; 0$.</p>
<h2 id="4-13-Wide-Baseline-Matching"><a href="#4-13-Wide-Baseline-Matching" class="headerlink" title="4.13 Wide Baseline Matching"></a>4.13 Wide Baseline Matching</h2><p><img src="https://cdn.jsdelivr.net/gh/Wastoon/myPicGo/img/930b4a946c9d21d6280785661df7b0ee.png"></p>
<p>Corresponding points and regions may look very different in different views. Determining correspondence is a challenge.</p>
<p>In the case of <code>wide baseline matching</code>, large parts of the image plane will not matching at all because they are not visible in the other image. In other words, while a given point may have many potential matches, quite possibly it does not have a correpsonding point in the other image.</p>
<h2 id="4-14-Extensions-to-Larger-Baseline"><a href="#4-14-Extensions-to-Larger-Baseline" class="headerlink" title="4.14 Extensions to Larger Baseline"></a>4.14 Extensions to Larger Baseline</h2><p>One of the limitations of tracking features frame by frame is that <code>small errors in the motion accumulate over time</code> and the window gradually moves away from the point that was originally tracked. This is known as <code>drift</code>.<br> A remedy is to match a given point back to the first frame. This generally implies larger displacements between frames.</p>
<p> Two aspects matter when extending the above simple feature tracking method to somewhat larger displacements:</p>
<ul>
<li>Since the motion of window between frames is (in general) no longer translational, one needs to <code>generalize the motion model</code> for the window $W(x)$, for example by using an <code>affine motion model</code>.</li>
<li>Since the illumination will change over time (especially when comparing more distant frames), one can replace the sum-of-squared-differences by the <code>normlized cross correlation</code> which is more <code>robost to illumination changes</code>.</li>
</ul>
<h2 id="4-15-Normlized-Cross-Correlation-（就是用均值和方差进行归一化处理）"><a href="#4-15-Normlized-Cross-Correlation-（就是用均值和方差进行归一化处理）" class="headerlink" title="4.15 Normlized  Cross Correlation （就是用均值和方差进行归一化处理）"></a>4.15 Normlized  Cross Correlation （就是用均值和方差进行归一化处理）</h2><p>The <code>normalized cross correlation</code> is defined as:<br>$$<br>NCC(h) &#x3D; \frac{\int_{W(x)}(I_1(x’)-\bar{I_1})(I_2(h(x’)) - \bar{I_2})dx’}{\sqrt{\int_{W(x)}(I_1(x’)-\bar{I_1})^2dx’ \int_{W(x)}(I_2(h(x’)) - \bar{I_2})^2dx’}}<br>$$<br>where $\bar{I_1}$ and $\bar{I_2}$ are the average intensity over the window $W(x)$. By subtracting this average intensity, the measure becomes <code>invariant to additive intensity changes</code> $I\rightarrow I+\gamma$. (对加法不敏感，即均值处理)<br>Dividing by the intensity variances of each window makes the measure <code>invariant to multiplicative changes</code> $I\rightarrow \gamma I$.(对乘法不敏感，即单位化)<br>If we stack the normlized intensity values of respective windows into one vector, $v_i\equiv vec(I_i - \bar{I_i})$, then the normlized cross correction is the <code>cosine of the angle between them</code>:<br>$$<br>NCC(h) &#x3D; \cos \angle(v_1, v_2).<br>$$</p>
<h2 id="4-16-Special-Case-Optimal-Affine-Transformation"><a href="#4-16-Special-Case-Optimal-Affine-Transformation" class="headerlink" title="4.16 Special Case: Optimal Affine Transformation"></a>4.16 Special Case: Optimal Affine Transformation</h2><p>The normalized cross correlation can be used to determine the optimal affine transformation between two given patches. Since the affine transformation is given by:<br>$$<br>h(x) &#x3D; Ax + d,<br>$$<br>we need to <code>maximize the cross correlation with respect to the 2x2-matrix </code> $A$ <code>and the displacement</code> $d$:<br>$$<br>\hat{A}, \hat{d} &#x3D; \\argmax_{A, d}NCC(A, d).<br>$$<br>where<br>$$<br>NCC(A, d) &#x3D; \frac{\int_{W(x)}(I_1(x’)-\bar{I_1})(I_2(Ax’+d) - \bar{I_2})dx’}{\sqrt{\int_{W(x)}(I_1(x’)-\bar{I_1})^2dx’ \int_{W(x)}(I_2(Ax’+d) - \bar{I_2})^2dx’}}<br>$$<br>Efficiently finding appropriate optima, however, is a challenge.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">KMnO4</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wastoon.github.io/2022/02/28/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E5%9B%9B%EF%BC%89/">https://wastoon.github.io/2022/02/28/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E5%9B%9B%EF%BC%89/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wastoon.github.io" target="_blank">KMnO4的行云小扎</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/">计算机视觉</a><a class="post-meta__tags" href="/tags/SFM/">SFM</a></div><div class="post_share"><div class="social-share" data-image="/img/MVG-4-cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.png" target="_blank"><img class="post-qr-code-img" src="/img/alipay.png" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/02/28/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E4%BA%94%EF%BC%89/"><img class="prev-cover" src="/img/MVG-5-cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">多视图几何（五）</div></div></a></div><div class="next-post pull-right"><a href="/2022/02/23/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E4%B8%89%EF%BC%89/"><img class="next-cover" src="/img/MVG-3-cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">多视图几何（三）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/02/21/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E4%B8%80%EF%BC%89/" title="MVG-多视图几何（一）"><img class="cover" src="/img/MVG-1-cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-21</div><div class="title">MVG-多视图几何（一）</div></div></a></div><div><a href="/2022/03/16/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E4%B8%83%EF%BC%89/" title="多视图几何（七）"><img class="cover" src="/img/MVG-7-cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-16</div><div class="title">多视图几何（七）</div></div></a></div><div><a href="/2022/02/23/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E4%B8%89%EF%BC%89/" title="多视图几何（三）"><img class="cover" src="/img/MVG-3-cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">多视图几何（三）</div></div></a></div><div><a href="/2022/02/23/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E4%BA%8C%EF%BC%89/" title="多视图几何（二）"><img class="cover" src="/img/MVG-2-cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-23</div><div class="title">多视图几何（二）</div></div></a></div><div><a href="/2022/02/28/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E4%BA%94%EF%BC%89/" title="多视图几何（五）"><img class="cover" src="/img/MVG-5-cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-28</div><div class="title">多视图几何（五）</div></div></a></div><div><a href="/2022/03/22/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E5%85%AB%EF%BC%89/" title="多视图几何（八）"><img class="cover" src="/img/MVG-8-cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-22</div><div class="title">多视图几何（八）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">KMnO4</div><div class="author-info__description">西安交通大学硕士（CV，3D人体姿态估计，动作生成）</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">11</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Wastoon"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Wastoon" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/mengrongye@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">Everything is the meaning of life.<div class="twopeople"><div class="twopeople"><div class="container"style="height:200px;"><canvas class="illo"width="800"height="800"style="max-width: 200px; max-height: 200px; touch-action: none; width: 640px; height: 640px;"></canvas></div><script src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/js/twopeople1.js"></script><script src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/js/zdog.dist.js"></script><script id="rendered-js"src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/js/twopeople.js"></script><style>.twopeople{margin:0;align-items:center;justify-content:center;text-align:center}canvas{display:block;margin:0 auto;cursor:move}</style></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter-4-Estimating-Point-Correspondence"><span class="toc-number">1.</span> <span class="toc-text">Chapter 4 Estimating Point Correspondence</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-From-Photometry-to-Geometry"><span class="toc-number">1.1.</span> <span class="toc-text">4.1 From Photometry to Geometry</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-Example-of-tracking"><span class="toc-number">1.2.</span> <span class="toc-text">4.2 Example of tracking</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-Identifying-Corresponding-Points"><span class="toc-number">1.3.</span> <span class="toc-text">4.3 Identifying Corresponding Points</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-Non-rigid-Deformation"><span class="toc-number">1.4.</span> <span class="toc-text">4.4 Non-rigid Deformation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-Small-Deformation-versus-Wide-Baseline"><span class="toc-number">1.5.</span> <span class="toc-text">4.5 Small Deformation versus Wide Baseline</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6-Small-Deformation"><span class="toc-number">1.6.</span> <span class="toc-text">4.6 Small Deformation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7-Optic-Flow-Estimation"><span class="toc-number">1.7.</span> <span class="toc-text">4.7 Optic Flow Estimation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-8-The-Lucas-Kanade-Method"><span class="toc-number">1.8.</span> <span class="toc-text">4.8 The Lucas-Kanade Method</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-9-Estimating-Local-Displacements"><span class="toc-number">1.9.</span> <span class="toc-text">4.9 Estimating Local Displacements</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-10-When-can-Small-Motion-be-Estimated"><span class="toc-number">1.10.</span> <span class="toc-text">4.10 When can Small Motion be Estimated?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-11-A-Simple-Feature-Tracking-Algorithm"><span class="toc-number">1.11.</span> <span class="toc-text">4.11 A Simple Feature Tracking Algorithm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-12-Robust-Feature-Point-Extraction"><span class="toc-number">1.12.</span> <span class="toc-text">4.12 Robust Feature Point Extraction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-13-Wide-Baseline-Matching"><span class="toc-number">1.13.</span> <span class="toc-text">4.13 Wide Baseline Matching</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-14-Extensions-to-Larger-Baseline"><span class="toc-number">1.14.</span> <span class="toc-text">4.14 Extensions to Larger Baseline</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-15-Normlized-Cross-Correlation-%EF%BC%88%E5%B0%B1%E6%98%AF%E7%94%A8%E5%9D%87%E5%80%BC%E5%92%8C%E6%96%B9%E5%B7%AE%E8%BF%9B%E8%A1%8C%E5%BD%92%E4%B8%80%E5%8C%96%E5%A4%84%E7%90%86%EF%BC%89"><span class="toc-number">1.15.</span> <span class="toc-text">4.15 Normlized  Cross Correlation （就是用均值和方差进行归一化处理）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-16-Special-Case-Optimal-Affine-Transformation"><span class="toc-number">1.16.</span> <span class="toc-text">4.16 Special Case: Optimal Affine Transformation</span></a></li></ol></li></ol></div></div><div class="card-widget card-weibo"><div class="card-content"><div class="item-headline"><i class="fab fa-weibo"></i><span>微博热搜</span></div><div id="weibo-container" style="width: 100%; height: 150px;font-size: 95%;"></div></div></div><script defer="defer" data-pjax="data-pjax" src="/js/card_weibo.js"></script><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/03/22/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E5%85%AB%EF%BC%89/" title="多视图几何（八）"><img src="/img/MVG-8-cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="多视图几何（八）"/></a><div class="content"><a class="title" href="/2022/03/22/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E5%85%AB%EF%BC%89/" title="多视图几何（八）">多视图几何（八）</a><time datetime="2022-03-22T13:26:10.000Z" title="发表于 2022-03-22 21:26:10">2022-03-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/16/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E4%B8%83%EF%BC%89/" title="多视图几何（七）"><img src="/img/MVG-7-cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="多视图几何（七）"/></a><div class="content"><a class="title" href="/2022/03/16/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E4%B8%83%EF%BC%89/" title="多视图几何（七）">多视图几何（七）</a><time datetime="2022-03-16T11:44:07.000Z" title="发表于 2022-03-16 19:44:07">2022-03-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/09/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E5%85%AD%EF%BC%89/" title="多视图几何（六）"><img src="/img/MVG-5-cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="多视图几何（六）"/></a><div class="content"><a class="title" href="/2022/03/09/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E5%85%AD%EF%BC%89/" title="多视图几何（六）">多视图几何（六）</a><time datetime="2022-03-09T08:15:24.000Z" title="发表于 2022-03-09 16:15:24">2022-03-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/28/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E4%BA%94%EF%BC%89/" title="多视图几何（五）"><img src="/img/MVG-5-cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="多视图几何（五）"/></a><div class="content"><a class="title" href="/2022/02/28/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E4%BA%94%EF%BC%89/" title="多视图几何（五）">多视图几何（五）</a><time datetime="2022-02-28T07:02:52.000Z" title="发表于 2022-02-28 15:02:52">2022-02-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/02/28/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E5%9B%9B%EF%BC%89/" title="多视图几何（四）"><img src="/img/MVG-4-cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="多视图几何（四）"/></a><div class="content"><a class="title" href="/2022/02/28/%E5%A4%9A%E8%A7%86%E5%9B%BE%E5%87%A0%E4%BD%95%EF%BC%88%E5%9B%9B%EF%BC%89/" title="多视图几何（四）">多视图几何（四）</a><time datetime="2022-02-28T06:43:44.000Z" title="发表于 2022-02-28 14:43:44">2022-02-28</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/MVG-4-cover.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By KMnO4</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '60cf579829afb2b2cdf9',
      clientSecret: '991dfac32f5e2bd0470bd4b8f5b8a2ef54e9b164',
      repo: 'Wastoon.github.io',
      owner: 'Wastoon',
      admin: ['Wastoon'],
      id: 'f30fa7289b1b0fc53271ec6ff93d4ba7',
      language: 'zh-CN',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: true,
      updateCountCallback: commentCount
    },false))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !true) {
  if (true) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="I,Miss,You" data-fontsize="15px" data-random="false" async="async"></script><script>((window.gitter = {}).chat = {}).options = {
  disableDefaultChat: true,
};
document.addEventListener('gitter-sidecar-ready', (e) => {
  const GitterChat = e.detail.Chat
  let chat

  function initGitter () {
    chat = new GitterChat({
      room: 'OMGsitetalk/community',
      activationElement: '#chat_btn'
    });
  }

  initGitter()

  if (false) {
    document.addEventListener('pjax:complete', () => {
      chat.destroy()
      initGitter()
    })
  }

})</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="async" defer="defer"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_clock_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src="https://cdn.jsdelivr.net/gh/tzy13755126023/BLOG_SOURCE/theme_f/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_injector_config();
  }
  </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax src="https://cdn.jsdelivr.net/npm/hexo-butterfly-clock/lib/clock.min.js"></script><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><script data-pjax src="https://cdn.jsdelivr.net/npm/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
                        function gitcalendar_injector_config(){
                          var parent_div_git = document.getElementById('recent-posts');
                          var item_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 280px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
                          parent_div_git.insertAdjacentHTML("afterbegin",item_html)
                          console.log('已挂载gitcalendar')
                          }

                        if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
                            gitcalendar_injector_config()
                            GitCalendarInit("https://gitcalendar.akilar.top/api?Wastoon",['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f'],'Wastoon')
                        }
                      </script><!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>